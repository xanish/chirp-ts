<div class="rounded-lg bg-white p-6 shadow-sm lg:w-1/2 xl:w-1/3">
  <div class="flex w-full justify-center">
    <h5 class="font-bold uppercase leading-6">
      {{
        type === tweetType.TWEET
          ? 'Compose Tweet'
          : type === tweetType.REPLY
          ? 'Compose Reply'
          : 'Compose Quote Retweet'
      }}
    </h5>
    <button
      type="button"
      (click)="closeModal()"
      class="ms-auto h-10 w-10 rounded-full bg-transparent text-center text-sm font-semibold uppercase leading-6 text-gray-500 hover:bg-gray-200"
    >
      <fa-icon [icon]="faXmark"></fa-icon>
    </button>
  </div>
  <form class="space-y-6" [formGroup]="form" (ngSubmit)="onSubmit()">
    <div>
      <label
        for="content"
        class="block text-xs font-bold uppercase tracking-wide text-gray-700"
        >Content</label
      >
      <div class="mt-2">
        <textarea
          id="content"
          name="content"
          formControlName="content"
          rows="4"
          placeholder="What's happening?"
          class="block w-full rounded border border-gray-200 bg-gray-200 px-4 py-3 text-gray-700 focus:border-indigo-600 focus:bg-white focus:outline-none"
        ></textarea>
      </div>
      <app-validation-message
        fieldName="content"
        [control]="form.get('content')!"
      ></app-validation-message>
    </div>

    <div>
      <input
        hidden
        type="file"
        fieldName="attachments"
        multiple="true"
        #attachments
        (change)="attachmentAdded($event)"
      />
    </div>

    <div
      class="mt-2 grid rounded-md"
      [ngClass]="gridClasses(medias.length)"
      *ngIf="medias.length > 0"
    >
      <ng-template ngFor let-attachment let-i="index" [ngForOf]="medias">
        <ng-container *ngIf="attachment.type === attachmentType.IMAGE">
          <div class="relative flex flex-col items-end">
            <button
              type="button"
              (click)="removeMedia(attachment.name)"
              class="absolute right-0 z-50 h-10 w-10 rounded-full bg-black bg-opacity-0 text-center text-sm font-semibold uppercase leading-6 text-gray-500 hover:bg-opacity-10"
            >
              <fa-icon [icon]="faXmark"></fa-icon>
            </button>
            <img
              class="h-full w-auto border"
              [ngClass]="medias.length === 1 ? '' : 'object-none'"
              src="{{ attachment.content }}"
            />
          </div>
        </ng-container>

        <ng-container *ngIf="attachment.type === attachmentType.VIDEO">
          <div class="relative flex flex-col items-end">
            <button
              type="button"
              (click)="removeMedia(attachment.name)"
              class="absolute right-0 z-50 h-10 w-10 rounded-full bg-transparent text-center text-sm font-semibold uppercase leading-6 text-gray-500 hover:bg-opacity-50"
            >
              <fa-icon [icon]="faXmark"></fa-icon>
            </button>
            <video
              class="h-full w-auto border"
              [ngClass]="medias.length === 1 ? '' : 'object-none'"
              src="{{ attachment.content }}"
              controls
            ></video>
          </div>
        </ng-container>
      </ng-template>
    </div>

    <div class="flex flex-row gap-4">
      <button
        type="button"
        (click)="attachments.click()"
        class="rounded-lg border-2 border-indigo-600 bg-white px-4 py-2 font-semibold uppercase leading-6 text-indigo-600 hover:bg-indigo-600 hover:text-white"
      >
        <fa-icon [icon]="faPaperclip"></fa-icon>
      </button>

      <button
        type="submit"
        [disabled]="!form.valid || disableSubmit"
        class="block w-full rounded-md bg-indigo-600 px-4 py-3 text-sm font-bold uppercase leading-6 text-white shadow-sm hover:bg-indigo-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:pointer-events-none disabled:bg-indigo-500"
      >
        Post
        <span class="mini-loader" *ngIf="disableSubmit"></span>
      </button>
    </div>
  </form>
</div>
